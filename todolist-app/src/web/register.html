<html>
   <head>
      <meta charset="utf-8">
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/water.css@2/out/water.css">
      <title>To Do List App</title>
   </head>
   <body>
      <h1>Register</h1>
      <form id="form">
         <input id="username" placeholder="username..." />
         <input id="password" placeholder="password..." type="password" />
         <button type="submit">Register</button>
      </form>

      <script>
         async function login(e) {
            e.preventDefault();

            const username = document.getElementById("username").value;
            const password = document.getElementById("password").value;

            const config = {
               method: "POST", // *GET, POST, PUT, DELETE, etc.
               mode: "cors", // no-cors, *cors, same-origin
               cache: "no-cache", // *default, no-cache, reload, force-cache, only-if-cached
               credentials: "same-origin", // include, *same-origin, omit
               headers: {
                  "Content-Type": "application/json",
                  // 'Content-Type': 'application/x-www-form-urlencoded',
               },
               redirect: "follow", // manual, *follow, error
               referrerPolicy: "no-referrer", // no-referrer, *no-referrer-when-downgrade, origin, origin-when-cross-origin, same-origin, strict-origin, strict-origin-when-cross-origin, unsafe-url
               body: JSON.stringify({ username, password }), // body data type must match "Content-Type" header
            };

            const response = await fetch(`/api/users`, config);
            const data = await response.json();
            
            if (response.status != 400 && response.status != 500) {
               console.log(data);
               location.href = "/login.html";
               return;
            }
            console.log(data)
            return false;
         }

         const form = document.getElementById("form");

         form.addEventListener("submit", login);
      </script>
   </body>
</html>
